<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div class="btngroup">
        <button type="button" class="btn" id="start_btn">開始</button>
        <button type="button" class="btn" id="restart_btn">放棄重來</button>
        <button type="button" class="btn" id="answer_btn">看答案</button>
    </div>

    <div class="guessgroup">
        <input type="text" maxlength="4" placeholder="請輸入4位不重覆數字" id="guess_input">
        <button type="button" class="btn" id="guess_btn">猜!</button>
    </div>

    <script>
        const guessInput = document.getElementById("guess_input")
        const guessBtn = document.getElementById("guess_btn")
        const restartBtn = document.getElementById("restart_btn")
        const startBtn = document.getElementById("start_btn")
        const showAnswer = document.getElementById("answer_btn")
        let min = 0
        let max = 9
        let answerArr = [] //為空   
        let answerNum
        let guessArr = []
        let numberArrIsSame

        function setGame() {
            do {
                let number = getRandomNumber(min, max)
                if (!answerArr.includes(number)) {
                    answerArr.push(number)
                }
            }
            while (answerArr.length != 4);
            return answerArr; //產生答案，型別為陣列
        }

        function guess() {
            guessBtn.addEventListener("click", function () {
                let guessNum = guessInput.value;
                let guessInputValue = guessNum;
                let guessArray = guessInputValue.split(""); //0619
                guessArr = guessArray.map(Number); //0620

                numberArrIsSame = new Set(guessArr);    //06.20            
                 if (guessNum === '' || isNaN(guessNum)  || guessArr.length != 4|| guessArr.length !== numberArrIsSame.size)                 
                {
                    alert('請輸入4位不重複數字')
                    guessInput.value = ''
                    return
                }
                let outPutA = 0;
                let outPutB = 0;
                for (let i = 0; i < answerArr.length; i++) {
                    if (answerArr[i] === guessArr[i]) {
                        outPutA += 1;
                    } else if (answerArr.includes(guessArr[i])) {
                        outPutB += 1;
                    }
                }
                document.body.append(`${outPutA}A${outPutB}B`, document.createElement("br")) //0620
            })
        }

        function init() {
            guessInput.value = ''
            guessBtn.disabled = false
        }

        window.onload = function () {
            setGame() //產生四位不重覆數字        
            guess() //遊戲邏輯運算
        }

        answer_btn.addEventListener("click", function () {
            answerNum = answerArr.map(Number).join('')
            alert(answerNum)
        })  //看答案

        restartBtn.addEventListener("click", function () {
            init()
            alert('目前沒用')
        }) //放棄重來

        startBtn.addEventListener("click", function () {           
            alert('目前沒用')
        }) //開始

        function getRandomNumber(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1) + min);
        }

    </script>

</body>

</html>